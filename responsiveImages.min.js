document.addEventListener("DOMContentLoaded",function(){(new function(){this.window_width=0,this.dataImgTag="data-img-sizes",this.dataImgWebPTag="data-img-sizes-webp",this.isWebP=!1,this.init=function(){var t=this,e=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./),i=e?parseInt(e[1]):0;(t.canUseWebp()||i>=65)&&(t.isWebP=!0),t.isWebP?(document.querySelectorAll("body ["+t.dataImgWebPTag+"]").forEach(function(e){t.countSizes(t,e)}),document.querySelectorAll("body ["+t.dataImgTag+"]:not(["+t.dataImgWebPTag+"])").forEach(function(e){t.countSizes(t,e)})):document.querySelectorAll("body ["+t.dataImgTag+"]").forEach(function(e){t.countSizes(t,e)}),t.resizeWindow(t),window.onresize=function(e){t.resizeWindow(t)}},this.canUseWebp=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))&&0==t.toDataURL("image/webp").indexOf("data:image/webp")},this.resizeWindow=function(t){t.window_width=document.body.clientWidth,t.isWebP?(document.querySelectorAll("body ["+t.dataImgWebPTag+"]").forEach(function(e){t.resizeImg(t,e)}),document.querySelectorAll("body ["+t.dataImgTag+"]:not(["+t.dataImgWebPTag+"])").forEach(function(e){t.resizeImg(t,e)})):document.querySelectorAll("body ["+t.dataImgTag+"]").forEach(function(e){t.resizeImg(t,e)})},this.countSizes=function(t,e){var i=e.getAttribute(t.dataImgTag);if(t.isWebP){var n=e.getAttribute(t.dataImgWebPTag);n&&(i=n)}(i=t.getSizes(i))&&(e.dataset.sizes=JSON.stringify(i))},this.getSizes=function(t){var e={},i=[];if(t&&(t=t.split(", "))&&t.length)for(var n in t){var a=t[n].split(" ");a&&a.length>0&&(a.length>1?i[parseInt(a[1])]=a[0]:i[0]=a[0])}for(var o in i)e[o]=i[o];return e},this.getImg=function(t,e){var i="";e[0]&&(i=e[0]);var n="";for(var a in e){if(parseInt(a)>t.window_width){i=e[a];break}n=e[a]}return""==i&&(i=n),i},this.resizeImg=function(t,e){var i=e.dataset.sizes;if(i){var n=t.getImg(t,JSON.parse(i)),a=new Image;a.src=n,a.onload=function(){"IMG"==e.tagName?e.setAttribute("src",n):e.style.backgroundImage="url("+n+")"}}}}).init()});
